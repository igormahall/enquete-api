# üìä API para Sistema de Enquetes

Um backend simples e robusto, constru√≠do com Django e Django REST Framework, para gerenciar enquetes de m√∫ltipla escolha.

Esta API permite listar enquetes ativas, visualizar suas op√ß√µes e registrar votos de forma segura ‚Äî prevenindo votos duplicados por participante.

## üõ† Tecnologias Utilizadas

- Python
- Django
- Django REST Framework (DRF)
- PostgreSQL

## ‚öôÔ∏è Configura√ß√£o do Projeto

Para configurar e executar o projeto em um ambiente de desenvolvimento local, siga os passos abaixo:

### 1Ô∏è‚É£ Clonar o Reposit√≥rio

```bash
git clone https://github.com/seu-usuario/seu-repositorio.git
cd seu-repositorio
```

### 2Ô∏è‚É£ Criar e Ativar o Ambiente Virtual

√â uma boa pr√°tica isolar as depend√™ncias do projeto.

```bash
# Criar o ambiente virtual
python -m venv .venv

# Ativar no Windows
.venv\Scripts\activate

# Ativar no macOS/Linux
source .venv/bin/activate
```

### 3Ô∏è‚É£ Instalar as Depend√™ncias

Instale as depend√™ncias listadas em `requirements.txt`:

```bash
pip install -r requirements.txt
```

### 4Ô∏è‚É£ Aplicar as Migra√ß√µes do Banco de Dados

Este comando cria as tabelas no banco de dados com base nos modelos definidos em `models.py`:

```bash
python manage.py migrate
```

### 5Ô∏è‚É£ Criar um Superusu√°rio

Voc√™ precisar√° de um usu√°rio administrador para acessar o painel administrativo do Django e cadastrar as primeiras enquetes e op√ß√µes para teste.

```bash
python manage.py createsuperuser
```

Siga as instru√ß√µes no terminal para definir nome, e-mail e senha.

---

## ‚ñ∂Ô∏è Executando a Aplica√ß√£o

Com o ambiente configurado, inicie o servidor de desenvolvimento do Django:

```bash
python manage.py runserver
```

A API estar√° dispon√≠vel em: [http://127.0.0.1:8000/](http://127.0.0.1:8000/)


---


## üóÑÔ∏è Modelo de Dados

A API √© sustentada por tr√™s modelos principais, que garantem a integridade e a l√≥gica do sistema de enquetes.

### üìù Enquete

Armazena as informa√ß√µes principais de cada enquete.

- `id`: Chave Prim√°ria (PK).
- `titulo`: T√≠tulo da enquete (ex: `"Qual sua linguagem favorita?"`).
- `data_criacao`: Data e hora em que a enquete foi criada.
- `status`: Estado atual da enquete (`"Aberta"`, `"Fechada"`).

### üó≥Ô∏è Opcao

Representa as alternativas de resposta para uma enquete.

- `id`: Chave Prim√°ria (PK).
- `enquete`: Chave Estrangeira (FK) que conecta a op√ß√£o √† sua enquete m√£e.
- `texto_opcao`: Texto da alternativa (ex: `"Python"`, `"JavaScript"`).
- `votos`: Contador num√©rico dos votos recebidos por esta op√ß√£o.

### üßæ Voto

Registra cada voto individual, funcionando como uma tabela de jun√ß√£o para controle e auditoria.

- `id`: Chave Prim√°ria (PK).
- `id_participante`: Identificador √∫nico do participante (ex: um ID de sess√£o do navegador).
- `enquete`: Chave Estrangeira (FK) para a enquete em que o voto foi registrado.
- `opcao_escolhida`: Chave Estrangeira (FK) para a op√ß√£o que foi votada.
- `data_voto`: Data e hora em que o voto foi computado.

### üîó Relacionamentos

- **Um-para-Muitos:**  
  Uma enquete pode ter v√°rias op√ß√µes. Este relacionamento √© definido pela chave estrangeira no modelo `Opcao`.

- **Controle de Voto √önico:**  
  A combina√ß√£o dos campos `enquete` e `id_participante` no modelo `Voto` √© √∫nica.  
  Isso garante a regra de neg√≥cio de que um mesmo participante n√£o pode votar mais de uma vez na mesma enquete.

---

## üìÑ Contrato da API (Endpoints para o Frontend)

A seguir est√£o os endpoints que devem ser consumidos pela aplica√ß√£o cliente (ex: Angular).

---

### 1Ô∏è‚É£ Listar Todas as Enquetes Ativas

- **Endpoint:** `GET /api/enquetes/`  
- **Descri√ß√£o:** Retorna uma lista com todas as enquetes que est√£o com o status "Aberta".  
- **Resposta de Sucesso (200 OK):**

```json
[
    {
        "id": 1,
        "titulo": "Qual sua linguagem de programa√ß√£o favorita?",
        "data_criacao": "2025-06-12T03:04:47.641235Z",
        "status": "Aberta",
        "opcoes": [
            {"id": 1, "texto_opcao": "Python", "votos": 15},
            {"id": 2, "texto_opcao": "JavaScript", "votos": 22}
        ]
    }
]
```

---

### 2Ô∏è‚É£ Obter Detalhes de uma Enquete Espec√≠fica

- **Endpoint:** `GET /api/enquetes/<id>/`  
- **Descri√ß√£o:** Retorna os dados completos de uma √∫nica enquete, incluindo suas op√ß√µes e a contagem de votos atual.  
- **Resposta de Sucesso (200 OK):**

```json
{
    "id": 1,
    "titulo": "Qual sua linguagem de programa√ß√£o favorita?",
    "data_criacao": "2025-06-12T03:04:47.641235Z",
    "status": "Aberta",
    "opcoes": [
        {"id": 1, "texto_opcao": "Python", "votos": 15},
        {"id": 2, "texto_opcao": "JavaScript", "votos": 22},
        {"id": 3, "texto_opcao": "Rust", "votos": 8}
    ]
}
```

---

### 3Ô∏è‚É£ Registrar um Voto em uma Enquete

- **Endpoint:** `POST /api/enquetes/<id>/votar/`  
- **Descri√ß√£o:** Registra um voto para uma op√ß√£o espec√≠fica de uma enquete. A API previne que um mesmo `id_participante` vote mais de uma vez na mesma enquete.  

- **Corpo da Requisi√ß√£o (Payload):**

```json
{
    "id_opcao": 2,
    "id_participante": "identificador-unico-do-navegador-do-usuario"
}
```

- **Resposta de Sucesso (200 OK):** Retorna o objeto da enquete com a contagem de votos atualizada.

```json
{
    "id": 1,
    "titulo": "Qual sua linguagem de programa√ß√£o favorita?",
    "opcoes": [
        {"id": 2, "texto_opcao": "JavaScript", "votos": 23}
    ]
}
```

- **Resposta de Erro (409 Conflict):** Voto Duplicado

```json
{
  "error": "Este participante j√° votou nesta enquete."
}
```

- **Resposta de Erro (400 Bad Request):** Op√ß√£o Inv√°lida

```json
{
  "error": "Op√ß√£o inv√°lida para esta enquete."
}
```

---

## üìú Licen√ßa

Este projeto est√° licenciado sob a Licen√ßa MIT.

---

## ü§ù Contribuindo

Contribui√ß√µes s√£o bem-vindas!  
Se voc√™ quiser sugerir melhorias, relatar bugs ou propor novas funcionalidades, sinta-se √† vontade para abrir uma *issue* ou *pull request*.

---
